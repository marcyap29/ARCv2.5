{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.epi.dev/mcp/bundle/v1.0",
  "title": "MCP Bundle Schema v1.0",
  "description": "Memory Container Protocol bundle format for portable memory export/import",
  "type": "object",
  "required": ["schemaVersion", "bundleId", "nodes", "edges"],
  "properties": {
    "schemaVersion": {
      "type": "string",
      "pattern": "^mcp-\\d+\\.\\d+$",
      "description": "MCP schema version (e.g., mcp-1.0)"
    },
    "bundleId": {
      "type": "string",
      "pattern": "^b-.+",
      "description": "Unique bundle identifier, should start with 'b-'"
    },
    "pointers": {
      "type": "array",
      "description": "External resource pointers",
      "items": {
        "type": "object",
        "required": ["id", "kind", "ref"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^p-.+",
            "description": "Pointer ID, should start with 'p-'"
          },
          "kind": {
            "type": "string",
            "enum": ["chat_session", "document", "media", "external_ref"],
            "description": "Type of external resource"
          },
          "ref": {
            "type": "string",
            "format": "uri",
            "description": "URI reference to external resource"
          }
        },
        "additionalProperties": true
      }
    },
    "nodes": {
      "type": "array",
      "description": "Memory graph nodes",
      "items": {
        "type": "object",
        "required": ["id", "type", "timestamp"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^n-.+",
            "description": "Node ID, should start with 'n-'"
          },
          "type": {
            "type": "string",
            "enum": [
              "entry", "keyword", "phase", "emotion", "arcform",
              "chat", "reflection", "summary", "insight", "unknown"
            ],
            "description": "Node type classification"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp in UTC"
          }
        },
        "additionalProperties": true
      }
    },
    "edges": {
      "type": "array",
      "description": "Memory graph relationships",
      "items": {
        "type": "object",
        "required": ["from", "to", "type"],
        "properties": {
          "from": {
            "type": "string",
            "description": "Source node ID"
          },
          "to": {
            "type": "string",
            "description": "Target node ID"
          },
          "type": {
            "type": "string",
            "enum": [
              "mentions", "phase_hint", "emotion_hint", "contains",
              "relates_to", "follows_from", "summarizes", "unknown"
            ],
            "description": "Relationship type"
          },
          "weight": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Relationship strength (0-1)"
          }
        },
        "additionalProperties": true
      }
    },
    "metadata": {
      "type": "object",
      "description": "Bundle-level metadata",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "exportedBy": {
          "type": "string"
        },
        "version": {
          "type": "string"
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": true
}